<analysis>**original_problem_statement:**
L'utente ha richiesto una serie di modifiche e nuove funzionalit√† per l'applicazione ERP Azienda Semplice. Le richieste pi√π recenti includono:

1.  **Correzione Bug Importazione**: Risolvere un problema per cui l'importazione del file Excel  popolava erroneamente la colonna dei bonifici anzich√© quella degli stipendi ().
2.  **Logica Contabile**: Invertire la formula del saldo in Prima Nota Salari in . Un saldo positivo (verde) indica un anticipo al dipendente, mentre uno negativo (rosso) indica un arretrato.
3.  **Gestione Duplicati**: Unificare i record duplicati (stesso dipendente, mese e anno) nella Prima Nota Salari.
4.  **Miglioramenti UI**:
    *   Aggiungere filtri inline direttamente sulle intestazioni della tabella Prima Nota Salari.
    *   Aggiungere una vista Tutti gli anni per aggregare i dati.
    *   Aggiungere un pulsante Modifica per ogni riga della tabella.
5.  **Nuova Funzionalit√† Archivio Bonifici**: Basandosi su un codice di esempio fornito, implementare una nuova sezione per caricare, processare e archiviare file PDF di bonifici bancari.
6.  **Fix Loop Infinito**: Risolvere un loop di rendering infinito nella nuova pagina .
7.  **Upload Massivo**: Estendere la funzionalit√† Archivio Bonifici per supportare l'upload di file ZIP contenenti fino a 1500 PDF, con un sistema di controllo per i duplicati.

**User's preferred language**: Italiano

**what currently exists?**
- Un'applicazione ERP full-stack (React + FastAPI) con un database MongoDB.
- La funzionalit√† Prima Nota Salari √® stata corretta: ora importa correttamente i dati da  e , calcola il saldo con la formula , e gestisce i record duplicati.
- L'interfaccia della Prima Nota Salari () √® stata migliorata con filtri inline sulle intestazioni della tabella, una vista Tutti gli anni e un pulsante Modifica per ogni record.
- √à stata creata una nuova pagina, Archivio Bonifici, per l'upload e la gestione di PDF di bonifici. Il relativo backend √® stato configurato in .
- Il loop di rendering infinito sulla pagina  √® stato risolto riscrivendo la logica degli  e .
- Il backend per l'Archivio Bonifici non supporta ancora l'upload di file ZIP di grandi dimensioni n√© la deduplicazione avanzata.

**Last working item**:
- **Last item agent was working**: L'agente aveva appena risolto il loop infinito nella pagina  riscrivendo il file . Stava per iniziare a modificare il backend per implementare la richiesta dell'utente di gestire l'upload massivo di file ZIP.
- **Status**: IN PROGRESS
- **Agent Testing Done**: N (Il fix del frontend non √® stato ancora verificato visivamente, e il lavoro sul backend non √® iniziato).
- **Which testing method agent to use?**:  per verificare che la pagina  non sia pi√π in loop. Successivamente, per il backend, sar√† necessario un test manuale con un file ZIP di grandi dimensioni.
- **User Testing Done**: N

**All Pending/In progress Issue list**:
- **Issue 1: Implementare upload massivo di file ZIP per Archivio Bonifici (P0)**
- **Issue 2: Click sui tab non funzionante nei test automatici (P1)**
- **Issue 3:  warning nel codice backend (P2)**

**Issues Detail:**
- **Issue 1: Implementare upload massivo di file ZIP per Archivio Bonifici (P0)**
    - **Attempted fixes**: Il frontend della pagina √® stato stabilizzato. Il lavoro sul backend non √® ancora iniziato.
    - **Next debug checklist**:
        1.  Modificare l'endpoint  in .
        2.  Implementare la gestione di file PK-Ô8&\ˇˇˇˇˇˇˇˇ-PKPK-Ô8&\∂!-PK/M per estrarre e processare i PDF in background, evitando timeout dell'API.
        3.  Prima di inserire un nuovo bonifico nel database, aggiungere una logica di deduplicazione per verificare l'esistenza di record con lo stesso ,  e .
        4.  Aggiornare lo stato del  (file totali, processati, errori) man mano che l'elaborazione in background procede.
    - **Why fix this issue and what will be achieved with this?**: Per completare la nuova funzionalit√† richiesta dall'utente, rendendola capace di gestire un grande volume di dati.
    - **Status**: IN PROGRESS
    - **Is recurring issue?**: N
    - **Should Test frontend/backend/both after fix?**: both
    - **Blocked on other issue**: None

- **Issue 2: Click sui tab non funzionante nei test automatici (P1)**
    - **Attempted fixes**: L'agente ha provato a usare , coordinate e JavaScript per cliccare sui tab della pagina  tramite lo , ma senza successo.
    - **Next debug checklist**:
        1.  Analizzare il componente  in  per eventuali stili CSS (, ) che potrebbero interferire con gli eventi di click durante l'automazione.
        2.  Come workaround, implementare la navigazione tra tab tramite parametri URL (es. ) per facilitare i test.
    - **Why fix this issue and what will be achieved with this?**: Risolvere questo problema, sebbene non sia un bug per l'utente, sbloccherebbe i test automatici dell'interfaccia, velocizzando lo sviluppo futuro.
    - **Status**: NOT STARTED
    - **Is recurring issue?**: Y
    - **Should Test frontend/backend/both after fix?**: frontend
    - **Blocked on other issue**: None

- **Issue 3:  warning nel codice backend (P2)**
    - **Attempted fixes**: Nessuno.
    - **Next debug checklist**:
        1.  Individuare i  in .
        2.  Sostituirli con  per catturare eccezioni specifiche e migliorare il logging.
    - **Why fix this issue and what will be achieved with this?**: Per migliorare la qualit√† del codice e la manutenibilit√†.
    - **Status**: NOT STARTED
    - **Is recurring issue?**: N
    - **Should Test frontend/backend/both after fix?**: backend
    - **Blocked on other issue**: None

**In progress Task List**:
- **Task 1: Completare la funzionalit√† Archivio Bonifici (P0)**
    - **Where to resume**: Dal file  per implementare la logica di upload massivo e deduplicazione.
    - **What will be achieved with this?**: Una funzionalit√† completa per archiviare bonifici bancari da file ZIP di grandi dimensioni.
    - **Status**: IN PROGRESS
    - **Should Test frontend/backend/both after fix?**: both
    - **Blocked on something**: None

**Upcoming and Future Tasks**
- **Upcoming Tasks**:
    - **(P1)** Risolvere il problema dei click sui tab per l'automazione dei test.
- **Future Tasks**:
    - **(P2)** Gestione Contratti: Implementare una sezione dedicata alla gestione dei contratti dei dipendenti.
    - **(P2)** Notifiche Scadenze: Aggiungere notifiche per le scadenze imminenti dei libretti sanitari.
    - **(P2)** Import Massivo Libretti Sanitari: Creare una funzionalit√† per importare pi√π libretti da un file Excel.
    - **(P2)** Report PDF: Generare un report PDF mensile riepilogativo per la sezione dipendenti.

**Completed work in this session**
- **Fix Pagina Dipendenti**: Risolto un errore di sintassi JSX in  che causava una pagina bianca.
- **Pulizia Codice Obsoleto**: Rimossi endpoint API, file di test () e collezioni DB () non pi√π utilizzati.
- **Correzione Logica Saldo**: Invertita la formula del saldo in Prima Nota Salari a  e aggiornati i colori della UI (verde/rosso) per riflettere la nuova logica contabile.
- **Gestione Duplicati**: Implementata una funzione per unificare i record duplicati (stesso dipendente/mese/anno) nella collezione .
- **Fix Parser Importazione**: Corretta la logica di parsing dei file Excel per distinguere correttamente tra Stipendio Netto (busta) e Importo Erogato (bonifico).
- **Miglioramenti UI Prima Nota Salari**: Aggiunti filtri inline sulle intestazioni della tabella, un'opzione Tutti gli anni e un modale di Modifica per ogni record.
- **Creazione Funzionalit√† Archivio Bonifici**: Creati la nuova pagina frontend () e il router backend () basati sul codice fornito.
- **Fix Loop Infinito**: Risolto un loop di rendering nella pagina .

**Earlier issues found/mentioned but not fixed**
- **Warning in Fatture.jsx**: Un warning non bloccante () √® ancora presente in .

**Known issue recurrence from previous fork**
- None

**Code Architecture**


**Key Technical Concepts**
- **Background Job Processing**: La nuova funzionalit√† Archivio Bonifici √® stata progettata per utilizzare un sistema di job in background per processare upload di file di grandi dimensioni senza bloccare l'API.
- **Data Unification**: √à stata implementata una logica per aggregare record multipli nel database basati su criteri di duplicazione (stesso dipendente, mese, anno), sommando i loro valori.
- **Specific Column Mapping**: La logica di importazione da Excel √® stata migliorata per utilizzare parole chiave pi√π specifiche (stipendio netto, importo erogato) ed evitare ambiguit√†.
- **React Hook Debugging**: √à stato identificato e risolto un loop infinito causato da una gestione errata delle dipendenze negli hook  e .

**key DB schema**
- ** (NEW)**: 
- ** (NEW)**: 

**changes in tech stack**
- , usage: pdfplumber [-h] [--structure | --structure-text]
                  [--format {csv,json,text}] [--types TYPES [TYPES ...]]
                  [--include-attrs INCLUDE_ATTRS [INCLUDE_ATTRS ...]]
                  [--exclude-attrs EXCLUDE_ATTRS [EXCLUDE_ATTRS ...]]
                  [--laparams LAPARAMS] [--precision PRECISION]
                  [--pages PAGES [PAGES ...]] [--indent INDENT]
                  [infile]

positional arguments:
  infile

options:
  -h, --help            show this help message and exit
  --structure           Write the structure tree as JSON. All other arguments
                        except --pages, --laparams, and --indent will be
                        ignored
  --structure-text      Write the structure tree as JSON including text
                        contents. All other arguments except --pages,
                        --laparams, and --indent will be ignored
  --format {csv,json,text}
  --types TYPES [TYPES ...]
  --include-attrs INCLUDE_ATTRS [INCLUDE_ATTRS ...]
                        Include *only* these object attributes in output.
  --exclude-attrs EXCLUDE_ATTRS [EXCLUDE_ATTRS ...]
                        Exclude these object attributes from output.
  --laparams LAPARAMS
  --precision PRECISION
  --pages PAGES [PAGES ...]
  --indent INDENT       Indent level for JSON pretty-printing., : Nuove librerie Python installate per il parsing dei file PDF nella funzionalit√† Archivio Bonifici.

**All files of reference**
- **Nuovi**:
    - 
    - 
- **Modificati pesantemente**:
    - 
    - 
- **Eliminati**:
    - 

**Areas that need refactoring**:
- Il file  contiene ancora dei  che andrebbero specificati.

**key api endpoints**
- : (NUOVO) Crea un nuovo job di importazione per i bonifici.
- : (NUOVO) Carica i file per un job specifico (da modificare per supportare ZIP).
- : (NUOVO) Aggiorna un singolo record della prima nota salari.
- : (MODIFICATO) Importa il file degli stipendi.
- : (MODIFICATO) Importa il file dei bonifici.

**Critical Info for New Agent**
- **PRIORIT√Ä 1**: Continuare l'implementazione della funzionalit√† Archivio Bonifici. Il frontend √® stato stabilizzato. Il prossimo passo √® implementare la logica di backend in  per gestire l'upload di file ZIP di grandi dimensioni e la deduplicazione dei record.
- **Logica Contabile**: La logica del saldo √® . Un valore positivo (verde) √® un anticipo al dipendente; un valore negativo (rosso) √® un arretrato. Mantenere questa convenzione.
- **Test Automatici UI**: Lo strumento di screenshot non riesce a cliccare sui tab della pagina . Questo √® un problema ricorrente che ostacola la verifica. Considerare un workaround (es. parametri URL) se la causa non viene trovata rapidamente.

**documents and test reports created in this job**
-  (aggiornato)

**Last 10 User Messages and any pending HUMAN messages**
10. **LATEST**:  - L'utente segnala un loop infinito nella pagina Archivio Bonifici e chiede di implementare l'upload di ZIP di grandi dimensioni. **Stato: IN PROGRESS**.
9.  - L'utente fornisce i file Excel di esempio per correggere il bug di importazione. **Stato: COMPLETATO**.
8.  - L'utente chiede di aggiungere i filtri inline alla tabella Prima Nota Salari. **Stato: COMPLETATO**.
7.  - L'utente segnala che la formula del saldo √® errata e chiede di gestire i duplicati. **Stato: COMPLETATO**.
6.  - L'utente chiede di correggere un record e aggiungere un pulsante Modifica alle righe. **Stato: COMPLETATO**.
5.  - L'utente richiede una vista aggregata per tutti gli anni. **Stato: COMPLETATO**.
4.  - L'utente chiede una pulizia generale del codice non utilizzato. **Stato: COMPLETATO**.
3.  - L'utente chiarisce la logica contabile per i colori e i totali del saldo. **Stato: COMPLETATO**.
2.  - L'utente fornisce un file ZIP con il codice per la nuova funzionalit√† Archivio Bonifici. **Stato: COMPLETATO (base implementata)**.
1.  - L'utente segnala il bug iniziale sull'importazione delle paghe. **Stato: COMPLETATO**.

**Project Health Check:**
- **Broken**: No. I problemi bloccanti (pagina bianca e loop infinito) sono stati risolti.
- **Mocked**: No.
- **Needs Cleanup**: S√¨. Il file  ha dei  warning.

**3rd Party Integrations**
- , : Per importazione/esportazione Excel.
- : Per i grafici nel frontend.
- , usage: pdfplumber [-h] [--structure | --structure-text]
                  [--format {csv,json,text}] [--types TYPES [TYPES ...]]
                  [--include-attrs INCLUDE_ATTRS [INCLUDE_ATTRS ...]]
                  [--exclude-attrs EXCLUDE_ATTRS [EXCLUDE_ATTRS ...]]
                  [--laparams LAPARAMS] [--precision PRECISION]
                  [--pages PAGES [PAGES ...]] [--indent INDENT]
                  [infile]

positional arguments:
  infile

options:
  -h, --help            show this help message and exit
  --structure           Write the structure tree as JSON. All other arguments
                        except --pages, --laparams, and --indent will be
                        ignored
  --structure-text      Write the structure tree as JSON including text
                        contents. All other arguments except --pages,
                        --laparams, and --indent will be ignored
  --format {csv,json,text}
  --types TYPES [TYPES ...]
  --include-attrs INCLUDE_ATTRS [INCLUDE_ATTRS ...]
                        Include *only* these object attributes in output.
  --exclude-attrs EXCLUDE_ATTRS [EXCLUDE_ATTRS ...]
                        Exclude these object attributes from output.
  --laparams LAPARAMS
  --precision PRECISION
  --pages PAGES [PAGES ...]
  --indent INDENT       Indent level for JSON pretty-printing., : (NUOVE) Per il parsing dei PDF.

**Testing status**
- **Testing agent used after significant changes**: NO
- **Troubleshoot agent used after agent stuck in loop**: NO
- **Test files created**: No
- **Known regressions**: Nessuna regressione funzionale nota. Persiste un problema con lo strumento di test automatico che non riesce a cliccare sui tab della UI.

**Credentials to test flow:**
N/A

**What agent forgot to execute**
- Niente di rilevante in questa sessione; l'agente ha seguito le richieste dell'utente in modo sequenziale.</analysis>
